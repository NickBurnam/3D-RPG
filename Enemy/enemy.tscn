[gd_scene load_steps=8 format=3 uid="uid://cdy6h7jf7vfn"]

[ext_resource type="Script" path="res://Enemy/Enemy.gd" id="1_58y1i"]
[ext_resource type="PackedScene" uid="uid://dll3md5b5ql3s" path="res://Player/rig.tscn" id="2_ciwx7"]
[ext_resource type="Script" path="res://Player/AttackCast.gd" id="3_6sy08"]
[ext_resource type="PackedScene" uid="uid://dyi76ppuxawf8" path="res://Player/area_attack.tscn" id="4_3s0wc"]
[ext_resource type="PackedScene" uid="uid://heag0q14bpcw" path="res://Components/health_component.tscn" id="4_smaun"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_r2qib"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_2kt5s"]

[node name="Enemy" type="CharacterBody3D"]
collision_layer = 9
script = ExtResource("1_58y1i")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_r2qib")

[node name="RigPivot" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)

[node name="Rig" parent="RigPivot" instance=ExtResource("2_ciwx7")]

[node name="Skeleton3D" parent="RigPivot/Rig/CharacterRig/GameRig" index="0"]
bones/0/position = Vector3(4.44009e-15, 0.896937, -0.0481735)
bones/2/rotation = Quaternion(-0.00192592, -0.000417444, 0.0032148, 0.999993)
bones/3/rotation = Quaternion(-0.0965639, -0.00038102, 0.00852, 0.99529)
bones/4/rotation = Quaternion(0.277185, 1.55428e-08, 9.07681e-08, 0.960816)
bones/6/rotation = Quaternion(-0.156032, -1.17825e-07, -1.81111e-08, 0.987752)
bones/7/position = Vector3(-2.004e-08, 0.896937, -0.0481734)
bones/8/position = Vector3(-5.06867e-08, 0.896937, -0.0481735)
bones/9/position = Vector3(0.131144, 0.963142, -0.0351291)
bones/9/rotation = Quaternion(0.992962, 0.0209023, -0.0309348, 0.112392)
bones/11/rotation = Quaternion(0.422019, -0.000700578, 0.00032627, 0.906586)
bones/13/rotation = Quaternion(-0.752366, 0.0118884, 0.0244083, 0.658186)
bones/15/position = Vector3(-0.131144, 0.963142, -0.0351291)
bones/15/rotation = Quaternion(0.973028, -0.00581403, 0.0273, 0.228994)
bones/17/rotation = Quaternion(0.445954, 0.00330167, -0.00164516, 0.895049)
bones/19/rotation = Quaternion(-0.68893, -0.0281966, -0.000681747, 0.724279)
bones/21/position = Vector3(0.0251286, 1.42715, 0.0423881)
bones/21/rotation = Quaternion(-0.492996, -0.258125, -0.400264, 0.72809)
bones/22/position = Vector3(0.188534, 1.46402, -0.0237903)
bones/22/rotation = Quaternion(0.0497239, -0.159713, 0.974449, -0.149898)
bones/23/rotation = Quaternion(6.68483e-08, -0.0160665, 6.05139e-08, 0.999871)
bones/24/rotation = Quaternion(0.299265, -0.0160672, -0.0183084, 0.953859)
bones/46/position = Vector3(-0.0113635, 1.42715, 0.0423881)
bones/46/rotation = Quaternion(-0.511653, 0.220067, 0.374266, 0.741422)
bones/47/position = Vector3(-0.167056, 1.46446, -0.0401107)
bones/47/rotation = Quaternion(-0.0758488, -0.136737, 0.973162, 0.168837)
bones/48/rotation = Quaternion(6.72177e-08, 0.0131512, 6.91783e-08, 0.999914)
bones/49/rotation = Quaternion(0.332161, 0.0131517, 0.0289518, 0.942686)
bones/71/position = Vector3(0.127191, 1.3456, -0.0263525)
bones/71/rotation = Quaternion(1.93158e-08, 0.61294, 0.790129, -4.64146e-08)
bones/72/position = Vector3(-0.113426, 1.3456, -0.0263525)
bones/72/rotation = Quaternion(1.93159e-08, 0.61294, 0.790129, -4.64145e-08)

[node name="Knight_02" parent="RigPivot/Rig/CharacterRig/GameRig/Skeleton3D" index="1"]
visible = false

[node name="Villager_01" parent="RigPivot/Rig/CharacterRig/GameRig/Skeleton3D" index="2"]
visible = true

[node name="RightHandBone" parent="RigPivot/Rig" index="2"]
transform = Transform3D(-0.962343, -0.270801, -0.0237164, 0.240838, -0.889808, 0.387608, -0.126068, 0.3673, 0.921519, -0.340873, 0.982858, -0.028814)

[node name="LeftHandBone" parent="RigPivot/Rig" index="3"]
transform = Transform3D(-0.970514, 0.239105, 0.0305246, -0.221454, -0.934462, 0.278816, 0.0951905, 0.263835, 0.959859, 0.345344, 0.970711, -0.0480684)

[node name="RayAttachment" type="BoneAttachment3D" parent="RigPivot/Rig"]
transform = Transform3D(-0.962343, -0.270801, -0.0237164, 0.240838, -0.889808, 0.387608, -0.126068, 0.3673, 0.921519, -0.340873, 0.982858, -0.028814)
bone_name = "DEF-hand.R"
bone_idx = 51
use_external_skeleton = true
external_skeleton = NodePath("../CharacterRig/GameRig/Skeleton3D")

[node name="AttackCast" type="RayCast3D" parent="RigPivot/Rig/RayAttachment"]
unique_name_in_owner = true
transform = Transform3D(-3.8097e-09, 4.35451e-08, 1, 0.996196, 0.0871558, -4.42399e-16, -0.0871559, 0.996195, -4.37115e-08, -0.03, 0.075, -0.05)
target_position = Vector3(0, 1, 0)
script = ExtResource("3_6sy08")

[node name="PlayerDetector" type="ShapeCast3D" parent="RigPivot/Rig"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_2kt5s")
target_position = Vector3(0, 0, 1)
collision_mask = 4

[node name="AreaAttack" parent="RigPivot/Rig" instance=ExtResource("4_3s0wc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1)
collision_mask = 4

[node name="HealthComponent" parent="." instance=ExtResource("4_smaun")]

[connection signal="heavy_attack" from="RigPivot/Rig" to="." method="_on_rig_heavy_attack"]
[connection signal="defeat" from="HealthComponent" to="." method="_on_health_component_defeat"]

[editable path="RigPivot/Rig"]
[editable path="RigPivot/Rig/CharacterRig"]
